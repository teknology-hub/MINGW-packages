--- a/libarchive/CMakeLists.txt
+++ b/libarchive/CMakeLists.txt
@@ -269,7 +269,7 @@ IF(WIN32 AND MSVC AND MSVC_USE_STATIC_CRT)
   SET_PROPERTY(TARGET archive_static PROPERTY MSVC_RUNTIME_LIBRARY "MultiThreaded$<$<CONFIG:Debug>:Debug>")
 ENDIF(WIN32 AND MSVC AND MSVC_USE_STATIC_CRT)
 # On Posix systems, libarchive.so and libarchive.a can co-exist.
-IF(NOT WIN32 OR CYGWIN OR NOT BUILD_SHARED_LIBS)
+IF(NOT MSVC OR NOT BUILD_SHARED_LIBS)
   SET_TARGET_PROPERTIES(archive_static PROPERTIES OUTPUT_NAME archive)
 ENDIF(NOT WIN32 OR CYGWIN OR NOT BUILD_SHARED_LIBS)

